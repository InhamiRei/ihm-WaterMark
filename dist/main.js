!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.createPoster=e():t.createPoster=e()}(window,(function(){return function(t){var e={};function r(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e);class a{constructor(t){if(!t||!t.container)throw new Error("The 'container' parameter is required and must be a valid DOM element.");if(e=t.container,!("object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName))throw new Error("The 'container' parameter must be a valid DOM element.");var e;this.params={container:t.container,width:250,height:150,fontSize:20,font:"microsoft yahei",color:"#cccccc",content:"watermark",rotate:-30,zIndex:1e3,opacity:.5,x:null,y:null,...t},this.params.x=null!==this.params.x&&void 0!==this.params.x?this.params.x:this.params.width/2,this.params.y=null!==this.params.y&&void 0!==this.params.y?this.params.y:this.params.height/2,this.styleStr=this.generateStyle(),this.containerObserver=new MutationObserver(this.handleContainerMutations.bind(this)),this.watermarkObserver=new MutationObserver(this.handleWatermarkMutations.bind(this))}generateStyle(){return`\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      z-index: ${this.params.zIndex};\n      pointer-events: none;\n      background-repeat: repeat;\n      background-image: url('${this.toDataURL()}');\n    `}toDataURL(){const{width:t,height:e,fontSize:r,font:a,color:n,rotate:i,content:o,opacity:s,x:c,y:l}=this.params,u=document.createElement("canvas");u.width=t,u.height=e;const h=u.getContext("2d");return h&&(h.clearRect(0,0,t,e),h.textBaseline="top",h.textAlign="left",h.fillStyle=n,h.globalAlpha=s,h.font=`${r}px ${a}`,h.translate(c,l),h.rotate(Math.PI/180*i),h.translate(-c,-l-r),h.fillText(o,c,l+r)),u.toDataURL()}getOrCreateWatermarkDom(){let t=this.params.container.querySelector(".ihm-watermark");return t||(t=document.createElement("div"),t.setAttribute("class","ihm-watermark"),this.params.container.style.position="relative",this.params.container.insertBefore(t,this.params.container.firstChild),this.watermarkObserver.observe(t,{attributes:!0,childList:!0,subtree:!0})),t}updateWatermarkStyle(){const t=this.getOrCreateWatermarkDom();t.getAttribute("style")!==this.styleStr&&t.setAttribute("style",this.styleStr)}handleContainerMutations(t,e){t.forEach(t=>{this.params.container.querySelector(".ihm-watermark")||this.updateWatermarkStyle()})}handleWatermarkMutations(t,e){t.forEach(t=>{this.updateWatermarkStyle()})}output(){this.updateWatermarkStyle(),this.containerObserver.observe(this.params.container,{attributes:!0,childList:!0,characterData:!0})}destroy(){const t=this.params.container.querySelector(".ihm-watermark");t&&t.remove(),this.watermarkObserver.disconnect(),this.containerObserver.disconnect()}}function n(t){return new a(t)}window.ihmWaterMark=n;e.default=n}]).default}));